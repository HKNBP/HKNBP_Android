<!--
  ~ HKNBP_Core is free software: you can redistribute it and/or modify
  ~ it under the terms of the GNU General Public License as published by
  ~ the Free Software Foundation, either version 3 of the License, or
  ~ (at your option) any later version.
  ~
  ~ HKNBP_Core is distributed in the hope that it will be useful,
  ~ MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  ~ GNU General Public License for more details.
  ~
  ~ You should have received a copy of the GNU General Public License
  ~ along with HKNBP_Core.  If not, see <https://www.gnu.org/licenses/>.
  -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
  <iframe id="iframePlayer" src="pip_test_1.html" width="500" height="500"></iframe>
  <button id="pictureInPictureButton">Toggle Picture-in-Picture</button>
  <script>
    var findVideoElement = function(iframe, onFindedVideoElement){
      var find = function(){
        if(iframe.contentWindow.document.getElementsByTagName("video").length <= 0){
          if(iframe.contentWindow.document.getElementsByTagName("iframe").length <= 0){
            console.log("findVideoElement");
          } else {
            findVideoElement(iframe.contentWindow.document.getElementsByTagName("iframe")[0], onFindedVideoElement);
          }
        }else{
          onFindedVideoElement(iframe.contentWindow.document.getElementsByTagName("video")[0]);
        }
      }
      find();
      iframe.onload = find;
    }

    var iframePlayer = document.getElementById("iframePlayer")
    findVideoElement(iframePlayer, function(video){
      pictureInPictureButton.addEventListener("click", function(event) {
        pictureInPictureButton.disabled = true;
        try {
          if (video !== document.pictureInPictureElement)
            video.requestPictureInPicture();
          else
            document.exitPictureInPicture();
        } catch(error) {
          console.log(error);
        } finally {
          pictureInPictureButton.disabled = false;
        }
      });
    });
  </script>
</body>
</html>
